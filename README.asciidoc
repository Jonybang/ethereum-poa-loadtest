# Ethereum AuRa (POA) Chain Load Test

## Workflow

### Installation

[source,sh]
.Install Node.js and Python dependencies
----
npm install
pip -r dependencies.txt
----

### Configure cloud provider
#### Google Cloud Engine

##### Setup credentials
Setup 3 following variable in .env (see .env.example):

* GCE_SERVICE_ACCOUNT - your service account name from `IAM & Admin` -> `Service Accounts` section
* GCE_KEY_PATH - path to your service account keys
* GCE_PROJECT_ID - project number from `Home` section

##### Setup SSH key

* Generate a new ssh key pair
* Rename user (before @ sign) in .pub file to `ubuntu`.
For ex., if your key in .pub file ends with `Vitalik@Vitaliks-MacBook-Pro.local`,
replace it with `ubuntu@Vitaliks-MacBook-Pro.local`.
* Go to `Compute Engine` -> `Metadata` -> `SSH keys` and paste your .pub key there.

##### Setup Firewall rules

* Go to `VPC Network` -> `Firewall rules`
* Add a rule with:
** Name: peer
** Target tags: peer-node
** Protocols/ports: tcp:8080,8545,8546,30303; udp:30301
* Add another rule:
** Name: validator
** Target tags: validator-node
** Protocols/ports: tcp:8545,8546,30303; udp:30301

### Fill required values in `group_vars/all`
** username - ubuntu username
** home - home folder for validator user
** genesis_network_name - the same name as in chain specification file `spec.json`
** timestamp - name of the folder (generated by `make generate` command)

### Bootstrap a network
* node app.js (rename) <- generates keys an chain map
* python providers/create.py <- launches instances in a cloud
* python providers/fetch.py <- fetches metadata from created instances
* ansible-playbook -i hosts.txt chain.yml <- provises cloud instances with software and configs

Now you should have your chain launched and sealing blocks.

### Test

Use agent client.js to schedule agent jobs.

TODO

### Results Collection

TODO
